
## Chapter 10. Recap - Kubernetes Architecture

노드(node)는 쿠버네티스가 설치된 물리적 가상 머신이다. 노드는 쿠버네티스가 작업을 수행하는 공간으로 컨테이너를 배포하는 장소이다. 예전에는 미니언즈(minions)라고 불렸다. 하나의 노드는 불안정하다. 여러 개의 노드들을 그룹지어 구성한 것이 클러스터다. 한 노드가 고장나도 다른 노드들이 대신 일을 수행하기 때문에 서비스가 중단되지 않는다. 

마스터(master) 노드는 클러스터 내 노드들을 관리하는 역할을 수행한다. 클러스터를 구성하는 노드들의 정보를 관리한다. 마스터도 쿠버네티스가 설치된 다른 노드이다. 작업자 노드의 오케스트레이션을 책임진다. 

쿠버네티스가 설치되면 다음과 같은 컴포넌트들이 생성된다.

- API Server
- etcd
- kubelet
- Container Runtime
- Controller
- Scheduler

API 서버는 쿠버네티스의 프론트 엔드처럼 동작한다. 사용자, CLI(command line interface) 모두 API 서버에 통신해 쿠버네티스 클러스터와 상호 작용한다. 

etcd는 분산되고 신뢰할 수 있는 키-값 저장소이다. 쿠버네티스가 클러스터 관리에 사용되는 모든 데이터를 저장한다.  클러스터 내 모든 노드에 관련된 정보를 분산 방식으로 저장한다. 마스터들 사이에 충돌이 없게 만들기 위해 클러스터 내에서 잠금 장치를 구현한다.

스케줄러는 다중 노드에 걸쳐 작업(job)이나 컨테이너를 배포하는 것을 책임진다. 새로 생성된 컨테이너를 찾아 노드에 할당한다. 

컨트롤러는 쿠버네티스 오케스트레이션 작업을 위한 브레인(brain)이다. 노드들, 컨테이너들의 엔드-포인트가 다운되는 것을 인지하고 대응하는 책임을 가지고 있다. 컨트롤러는 새로운 컨테이너를 들여올지 결정하는 역할을 수행한다.

컨테이너 런타임은 컨테이너를 실행하기 위한 기본 소프트웨이다. 기본적으로 도커를 사용하지만, 변경 가능하다.

kubelet은 클러스터 각 노드에서 실행되는 에이전트이다. 에이전트는 컨테이너가 노드에서 실행되는지 확인한다. 

### 마스터 노드와 작업자(worker) 노드들

작업자 노드는 컨테이너가 호스팅되는 곳이다. 시스템에서 도커 컨테이너를 실행하려면 컨테이너 런타임이 필요하다. 기본적으로 도커를 사용하지만, Rocket, CRI-O 같은 다른 컨테이너 런타임 대안이 존재한다. 

마스터 노드는 kube-API 서버를 가지고 있다. 작업자 노드에는 kubelet 에이전트가 설치되어 있다. 마스터 노드의 API 서버와 상호 작용한다. 노드의 헬스(health) 정보를 제공한다. 이 외에도 마스터가 요청한 작업들을 수행한다. 수집된 정보들은 마스터 노드의 etcd 키-값 저장소에 저장된다. 마지막으로 마스터 노드에 컨트롤러, 스케줄러도 설치된다.

### kubectl

kubectl 명령어는 쿠버네티스 명령어를 수행하는 CLI 명령어다. 클러스터 상의 응용 프로그램을 배포 및 관리하는 데 사용된다. 클러스터 정보를 얻고 클러스터 내의 다른 노드들의 상태를 얻고 관리한다. 다양한 쿠버네티스 명령어가 존재한다. 
